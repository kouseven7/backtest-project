[2025-02-20 15:54:55,345] ERROR - __main__ - バックテスト実行中にエラーが発生しました。
Traceback (most recent call last):
  File "C:\Users\imega\Documents\my_backtest_project\main.py", line 114, in main
    ticker, start_date, end_date, stock_data = get_parameters_and_data()
                                               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\imega\Documents\my_backtest_project\main.py", line 26, in get_parameters_and_data
    from config.error_handling import read_excel_parameters, fetch_stock_data
  File "C:\Users\imega\Documents\my_backtest_project\config\error_handling.py", line 6, in <module>
    import yfinance as yf
ModuleNotFoundError: No module named 'yfinance'
[2025-02-20 16:03:29,889] ERROR - __main__ - バックテスト実行中にエラーが発生しました。
Traceback (most recent call last):
  File "C:\Users\imega\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Users\imega\AppData\Local\Programs\Python\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\imega\Documents\my_backtest_project\main.py", line 114, in main
    ticker, start_date, end_date, stock_data = get_parameters_and_data()
                                               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\imega\Documents\my_backtest_project\main.py", line 28, in get_parameters_and_data
    config_df = read_excel_parameters(config_file, "銘柄設定")
                ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\imega\Documents\my_backtest_project\config\error_handling.py", line 22, in read_excel_parameters
    df = pd.read_excel(excel_file, sheet_name=sheet_name)
  File "C:\Users\imega\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\imega\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\imega\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\imega\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
[2025-02-20 16:08:43,105] INFO - __main__ - パラメータ取得: 8410.T, 2022-01-01, 2023-01-01
[2025-02-20 16:08:45,846] WARNING - __main__ - '8410.T' のデータに 'Adj Close' が存在しないため、'Close' 列を代用します。
[2025-02-20 16:08:45,885] INFO - __main__ - 前処理（リターン、ボラティリティ計算）完了
[2025-02-20 16:08:45,947] INFO - __main__ - インジケーター計算完了
[2025-02-20 16:08:45,975] INFO - __main__ - 戦略適用（シグナル生成）完了
[2025-02-20 16:08:46,151] INFO - __main__ - バックテスト（トレードシミュレーション）完了
[2025-02-20 16:08:46,215] INFO - __main__ - バックテスト結果をExcelに出力完了
[2025-02-20 16:08:46,371] INFO - __main__ - Excelのチャート、ピボットテーブル追加完了
[2025-02-20 16:08:46,371] INFO - __main__ - 全体のバックテスト処理が正常に完了しました。
[2025-02-20 16:12:58,392] INFO - __main__ - パラメータ取得: 8410.T, 2022-01-01, 2023-01-01
[2025-02-20 16:12:59,002] WARNING - __main__ - '8410.T' のデータに 'Adj Close' が存在しないため、'Close' 列を代用します。
[2025-02-20 16:12:59,010] INFO - __main__ - 前処理（リターン、ボラティリティ計算）完了
[2025-02-20 16:12:59,023] INFO - __main__ - インジケーター計算完了
[2025-02-20 16:12:59,033] INFO - __main__ - 戦略適用（シグナル生成）完了
[2025-02-20 16:12:59,174] INFO - __main__ - バックテスト（トレードシミュレーション）完了
[2025-02-20 16:12:59,256] INFO - __main__ - バックテスト結果をExcelに出力完了
[2025-02-20 16:12:59,407] INFO - __main__ - Excelのチャート、ピボットテーブル追加完了
[2025-02-20 16:12:59,407] INFO - __main__ - 全体のバックテスト処理が正常に完了しました。
[2025-02-20 16:30:13,234] INFO - __main__ - パラメータ取得: 8410.T, 2022-01-01, 2023-01-01
[2025-02-20 16:30:13,756] WARNING - __main__ - '8410.T' のデータに 'Adj Close' が存在しないため、'Close' 列を代用します。
[2025-02-20 16:30:13,767] INFO - __main__ - 前処理（リターン、ボラティリティ計算）完了
[2025-02-20 16:30:13,796] INFO - __main__ - インジケーター計算完了
[2025-02-20 16:30:13,808] INFO - __main__ - 戦略適用（シグナル生成）完了
[2025-02-20 16:30:13,953] INFO - __main__ - バックテスト（トレードシミュレーション）完了
[2025-02-20 16:30:14,013] INFO - __main__ - バックテスト結果をExcelに出力完了
[2025-02-20 16:30:14,161] INFO - __main__ - Excelのチャート、ピボットテーブル追加完了
[2025-02-20 16:30:14,161] INFO - __main__ - 全体のバックテスト処理が正常に完了しました。
[2025-02-20 16:31:07,317] INFO - __main__ - パラメータ取得: 8410.T, 2022-01-01, 2023-01-01
[2025-02-20 16:31:07,826] WARNING - __main__ - '8410.T' のデータに 'Adj Close' が存在しないため、'Close' 列を代用します。
[2025-02-20 16:31:07,835] INFO - __main__ - 前処理（リターン、ボラティリティ計算）完了
[2025-02-20 16:31:07,849] INFO - __main__ - インジケーター計算完了
[2025-02-20 16:31:07,858] INFO - __main__ - 戦略適用（シグナル生成）完了
[2025-02-20 16:31:07,992] INFO - __main__ - バックテスト（トレードシミュレーション）完了
[2025-02-20 16:31:08,049] INFO - __main__ - バックテスト結果をExcelに出力完了
[2025-02-20 16:31:08,199] INFO - __main__ - Excelのチャート、ピボットテーブル追加完了
[2025-02-20 16:31:08,199] INFO - __main__ - 全体のバックテスト処理が正常に完了しました。
[2025-02-20 18:55:06,347] INFO - __main__ - パラメータ取得: 8410.T, 2022-01-01, 2023-01-01
[2025-02-20 18:55:07,073] WARNING - __main__ - '8410.T' のデータに 'Adj Close' が存在しないため、'Close' 列を代用します。
[2025-02-20 18:55:07,083] INFO - __main__ - 前処理（リターン、ボラティリティ計算）完了
[2025-02-20 18:55:07,101] INFO - __main__ - インジケーター計算完了
[2025-02-20 18:55:07,113] INFO - __main__ - 戦略適用（シグナル生成）完了
[2025-02-20 18:55:07,251] INFO - __main__ - バックテスト（トレードシミュレーション）完了
[2025-02-20 18:55:07,310] INFO - __main__ - バックテスト結果をExcelに出力完了
[2025-02-20 18:55:07,457] INFO - __main__ - Excelのチャート、ピボットテーブル追加完了
[2025-02-20 18:55:07,457] INFO - __main__ - 全体のバックテスト処理が正常に完了しました。
