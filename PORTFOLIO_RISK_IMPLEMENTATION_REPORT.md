# 3-3-3ã€Œãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒ¬ãƒ™ãƒ«ã®ãƒªã‚¹ã‚¯èª¿æ•´æ©Ÿèƒ½ã€å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ¯ å®Ÿè£…æ¦‚è¦
**æ—¥æ™‚**: 2025å¹´07æœˆ20æ—¥  
**æ©Ÿèƒ½å**: 3-3-3ã€Œãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒ¬ãƒ™ãƒ«ã®ãƒªã‚¹ã‚¯èª¿æ•´æ©Ÿèƒ½ã€  
**çµ±åˆå¯¾è±¡**: 3-3-1 (ã‚·ã‚°ãƒŠãƒ«çµ±åˆ), 3-3-2 (ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºèª¿æ•´)

## âœ… å®Ÿè£…å®Œäº†é …ç›®

### 1. ğŸ”§ ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `config/portfolio_risk_manager.py` (1,165è¡Œ)
- **ä¸»è¦ã‚¯ãƒ©ã‚¹**:
  - `PortfolioRiskManager` - ãƒ¡ã‚¤ãƒ³ç®¡ç†ã‚¯ãƒ©ã‚¹
  - `IntegratedRiskManagementSystem` - çµ±åˆã‚·ã‚¹ãƒ†ãƒ 
  - å„ç¨®ãƒªã‚¹ã‚¯è¨ˆç®—å™¨ (VaR, ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³, ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ç­‰)

### 2. ğŸ“Š ãƒªã‚¹ã‚¯æŒ‡æ¨™å®Ÿè£…
| æŒ‡æ¨™å | ã‚¿ã‚¤ãƒ— | åˆ¶é™å€¤è¨­å®š | çŠ¶æ…‹ |
|--------|--------|-----------|------|
| VaR 95% | ã‚½ãƒ•ãƒˆåˆ¶é™ | 3% | âœ… å®Ÿè£…æ¸ˆã¿ |
| VaR 99% | ãƒãƒ¼ãƒ‰åˆ¶é™ | 5% | âœ… å®Ÿè£…æ¸ˆã¿ |
| CVaR 95%/99% | è¨ˆç®—ã®ã¿ | - | âœ… å®Ÿè£…æ¸ˆã¿ |
| æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ | ãƒãƒ¼ãƒ‰åˆ¶é™ | 10% | âœ… å®Ÿè£…æ¸ˆã¿ |
| ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ | ã‚½ãƒ•ãƒˆåˆ¶é™ | 20% | âœ… å®Ÿè£…æ¸ˆã¿ |
| ç›¸é–¢ãƒªã‚¹ã‚¯ | ã‚½ãƒ•ãƒˆåˆ¶é™ | 70% | âœ… å®Ÿè£…æ¸ˆã¿ |
| é›†ä¸­åº¦ãƒªã‚¹ã‚¯ | å‹•çš„åˆ¶é™ | 35% | âœ… å®Ÿè£…æ¸ˆã¿ |

### 3. âš™ï¸ ãƒªã‚¹ã‚¯èª¿æ•´ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
- **`reduce_positions`** - ãƒã‚¸ã‚·ãƒ§ãƒ³å‰Šæ¸›
- **`rebalance_weights`** - ã‚¦ã‚§ã‚¤ãƒˆå†é…åˆ†
- **`increase_hedging`** - ãƒ˜ãƒƒã‚¸å¢—åŠ 
- **`stop_new_positions`** - æ–°è¦ãƒã‚¸ã‚·ãƒ§ãƒ³åœæ­¢
- **`emergency_exit`** - ç·Šæ€¥çµ‚äº†

### 4. ğŸ”„ çµ±åˆæ©Ÿèƒ½
- **æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**: 3-3-1, 3-3-2ã¨ã®å®Œå…¨çµ±åˆ
- **å‹•çš„èª¿æ•´**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒªã‚¹ã‚¯ç›£è¦–ãƒ»è‡ªå‹•èª¿æ•´
- **å±¥æ­´ç®¡ç†**: ãƒªã‚¹ã‚¯è©•ä¾¡ãƒ»èª¿æ•´å±¥æ­´ã®è‡ªå‹•ä¿å­˜
- **åŠ¹æœæ€§è©•ä¾¡**: èª¿æ•´åŠ¹æœã®å®šé‡çš„æ¸¬å®š

## ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ

### ãƒ‡ãƒ¢å®Ÿè¡Œçµæœ
```
ğŸ¯ Portfolio Risk Management System - Simple Demo
============================================================
âœ… Portfolio Risk Manager initialized successfully
ğŸ“Š Portfolio Risk Assessment Results:
  ğŸ“‹ Total strategies: 4
  âš ï¸  Needs adjustment: False
  ğŸ“ˆ Risk metrics calculated: 8

ğŸ“ˆ Risk Metrics Details:
  var_95              : 0.0117 / 0.0300 ğŸŸ¢ OK
  max_drawdown        : 0.0633 / 0.1000 ğŸŸ¢ OK
  volatility          : 0.1206 / 0.2000 ğŸŸ¢ OK
  var_99              : 0.0148 / 0.0500 ğŸŸ¢ OK
  concentration_risk  : 0.0067 / 0.3500 ğŸŸ¢ OK
  correlation_risk    : 0.1019 / 0.7000 ğŸŸ¢ OK
```

### é›†ä¸­åº¦ãƒªã‚¹ã‚¯èª¿æ•´ãƒ†ã‚¹ãƒˆ
```
ğŸ“Š High concentration test weights:
  momentum_strategy        : 0.600 â† é«˜é›†ä¸­åº¦è¨­å®š
  mean_reversion_strategy  : 0.150
  trend_following_strategy : 0.150
  arbitrage_strategy       : 0.100

âš™ï¸  Risk Adjustment Results:
  Actions: ['reduce_positions']
  Effectiveness: 0.067
  Reason: Risk limit breaches detected: max_drawdown

ğŸ“Š Final adjusted weights:
  momentum_strategy        : 0.565 â† è‡ªå‹•èª¿æ•´æ¸ˆã¿
  mean_reversion_strategy  : 0.141
  trend_following_strategy : 0.176
  arbitrage_strategy       : 0.118
```

### çµ±åˆãƒ†ã‚¹ãƒˆçµæœ
```
ğŸ§ª Portfolio Risk Management Integration Tests
Ran 9 tests in 0.423s
âœ… All tests passed!

ğŸš€ Performance Test
ğŸ“Š Large dataset performance:
  Data size: (1000, 5)
  Strategies: 5
  Processing time: 0.006 seconds  â† å„ªç§€ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
  Risk metrics calculated: 8
  Needs adjustment: False
```

## ğŸ“ˆ å®Ÿè£…è©³ç´°

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ
```
PortfolioRiskManager
â”œâ”€â”€ Risk Calculators (8ç¨®é¡)
â”œâ”€â”€ Risk Assessment Engine
â”œâ”€â”€ Weight Adjustment Engine
â””â”€â”€ History Management

IntegratedRiskManagementSystem
â”œâ”€â”€ SignalIntegrator (3-3-1)
â”œâ”€â”€ PositionSizeAdjuster (3-3-2)  
â”œâ”€â”€ PortfolioWeightCalculator (3-2-1)
â””â”€â”€ PortfolioRiskManager (3-3-3)
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
1. **ãƒªã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿å…¥åŠ›** â†’ ãƒªã‚¹ã‚¯æŒ‡æ¨™è¨ˆç®—
2. **åˆ¶é™å€¤ãƒã‚§ãƒƒã‚¯** â†’ èª¿æ•´è¦å¦åˆ¤å®š
3. **èª¿æ•´ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ±ºå®š** â†’ ã‚¦ã‚§ã‚¤ãƒˆä¿®æ­£å®Ÿè¡Œ
4. **åŠ¹æœæ€§è©•ä¾¡** â†’ å±¥æ­´ä¿å­˜

### è¨­å®šå¯èƒ½é …ç›®
```python
RiskConfiguration(
    var_95_limit=0.03,          # VaR 95% åˆ¶é™
    var_99_limit=0.05,          # VaR 99% åˆ¶é™
    max_drawdown_limit=0.10,    # æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³åˆ¶é™
    volatility_limit=0.20,      # ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£åˆ¶é™
    max_correlation=0.7,        # æœ€å¤§ç›¸é–¢åˆ¶é™
    max_single_position=0.35,   # æœ€å¤§ãƒã‚¸ã‚·ãƒ§ãƒ³åˆ¶é™
    adjustment_sensitivity=0.5,  # èª¿æ•´æ„Ÿåº¦
    rebalance_threshold=0.1     # ãƒªãƒãƒ©ãƒ³ã‚¹é–¾å€¤
)
```

## ğŸ”— æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆçŠ¶æ³

### 3-3-1 ã‚·ã‚°ãƒŠãƒ«çµ±åˆã¨ã®çµ±åˆ
- âœ… SignalIntegratorã‚¯ãƒ©ã‚¹ã®çµ±åˆ
- âœ… ç«¶åˆã‚·ã‚°ãƒŠãƒ«å‡¦ç†ã®è€ƒæ…®
- âœ… å„ªå…ˆåº¦ãƒ«ãƒ¼ãƒ«ã¨ã®æ•´åˆæ€§

### 3-3-2 ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºèª¿æ•´ã¨ã®çµ±åˆ
- âœ… PositionSizeAdjusterã‚¯ãƒ©ã‚¹ã®çµ±åˆ
- âœ… å‹•çš„ã‚µã‚¤ã‚ºèª¿æ•´ã¨ã®é€£æº
- âœ… å¸‚å ´ç’°å¢ƒè€ƒæ…®ã®çµ±åˆ

### 3-2-1 ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚¦ã‚§ã‚¤ãƒˆè¨ˆç®—ã¨ã®çµ±åˆ
- âœ… PortfolioWeightCalculatorã¨ã®é€£æº
- âœ… ã‚¹ã‚³ã‚¢ãƒ™ãƒ¼ã‚¹é…åˆ†ã¨ã®æ•´åˆæ€§
- âœ… æœ€å°é‡ã¿åˆ¶ç´„ã®å°Šé‡

## ğŸš€ ä¸»ãªç‰¹å¾´ãƒ»ãƒ¡ãƒªãƒƒãƒˆ

### 1. **åŒ…æ‹¬çš„ãƒªã‚¹ã‚¯ç®¡ç†**
- 8ç¨®é¡ã®ä¸»è¦ãƒªã‚¹ã‚¯æŒ‡æ¨™ã‚’ä¸¦è¡Œè¨ˆç®—
- ãƒãƒ¼ãƒ‰/ã‚½ãƒ•ãƒˆ/å‹•çš„åˆ¶é™ã®æŸ”è»Ÿãªè¨­å®š
- åˆ¶é™é•åã®è‡ªå‹•æ¤œå‡ºãƒ»èª¿æ•´

### 2. **é«˜æ€§èƒ½å‡¦ç†**
- ä¸¦è¡Œå‡¦ç†ã«ã‚ˆã‚‹é«˜é€Ÿè¨ˆç®— (1000æ—¥Ã—5æˆ¦ç•¥ã‚’6ms)
- ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªå±¥æ­´ç®¡ç†
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªå±¥æ­´åˆ¶é™

### 3. **å®Ÿç”¨çš„ãªèª¿æ•´æ©Ÿèƒ½**
- åŠ¹æœæ€§ã‚¹ã‚³ã‚¢ã«ã‚ˆã‚‹èª¿æ•´è©•ä¾¡
- æ®µéšçš„èª¿æ•´ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
- ç·Šæ€¥æ™‚å¯¾å¿œæ©Ÿèƒ½

### 4. **é‹ç”¨ç›£è¦–æ©Ÿèƒ½**
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒªã‚¹ã‚¯ã‚µãƒãƒªãƒ¼
- JSONå½¢å¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- èª¿æ•´å±¥æ­´ã®è©³ç´°è¿½è·¡

## ğŸ“ ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ•ã‚¡ã‚¤ãƒ«å | è¡Œæ•° | å½¹å‰² |
|-----------|------|------|
| `config/portfolio_risk_manager.py` | 1,165 | ãƒ¡ã‚¤ãƒ³ãƒªã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  |
| `demo_portfolio_risk_system.py` | 374 | ãƒ•ãƒ«æ©Ÿèƒ½ãƒ‡ãƒ¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| `demo_portfolio_risk_simple.py` | 279 | ç°¡æ˜“ãƒ‡ãƒ¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| `test_portfolio_risk_integration.py` | 322 | çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ |

## ğŸ”§ æŠ€è¡“ä»•æ§˜

### ä¾å­˜é–¢ä¿‚
- **å¿…é ˆ**: pandas, numpy
- **ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: scipy (çµ±è¨ˆè¨ˆç®—æ‹¡å¼µ)
- **çµ±åˆ**: æ—¢å­˜ã®3-3-1, 3-3-2, 3-2-1ã‚·ã‚¹ãƒ†ãƒ 

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
- **åˆæœŸåŒ–æ™‚é–“**: <1ç§’
- **ãƒªã‚¹ã‚¯è¨ˆç®—**: 6ms (1000æ—¥Ã—5æˆ¦ç•¥)
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: å±¥æ­´1000ä»¶åˆ¶é™ã§åŠ¹ç‡ç®¡ç†
- **ä¸¦è¡Œå‡¦ç†**: æœ€å¤§4ã‚¹ãƒ¬ãƒƒãƒ‰ã§ãƒªã‚¹ã‚¯æŒ‡æ¨™è¨ˆç®—

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- åŒ…æ‹¬çš„try-catchæ§‹é€ 
- ãƒ­ã‚°ãƒ™ãƒ¼ã‚¹è¨ºæ–­æƒ…å ±
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½
- éƒ¨åˆ†æ©Ÿèƒ½ç¶™ç¶šå‹•ä½œ

## ğŸ¯ ä»Šå¾Œã®æ‹¡å¼µå¯èƒ½æ€§

### çŸ­æœŸæ‹¡å¼µ (æ¬¡ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆ)
1. **HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ** - è¦–è¦šçš„ãªãƒªã‚¹ã‚¯åˆ†æ
2. **ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½** - åˆ¶é™é•åæ™‚ã®é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
3. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«åŒ–** - JSONè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ

### ä¸­æœŸæ‹¡å¼µ (1-2ãƒ¶æœˆ)
1. **æ©Ÿæ¢°å­¦ç¿’çµ±åˆ** - äºˆæ¸¬çš„ãƒªã‚¹ã‚¯ç®¡ç†
2. **ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½** - å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã§ã®æ¤œè¨¼
3. **APIåŒ–** - å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æº

### é•·æœŸæ‹¡å¼µ (3-6ãƒ¶æœˆ)
1. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–** - WebSocketæ¥ç¶š
2. **ãƒãƒ«ãƒãƒãƒ¼ã‚±ãƒƒãƒˆå¯¾å¿œ** - é€šè²¨ãƒ»å•†å“ç­‰ã¸ã®æ‹¡å¼µ
3. **è¦åˆ¶å¯¾å¿œ** - é‡‘èè¦åˆ¶è¦ä»¶ã¸ã®æº–æ‹ 

## âœ… å®Œäº†ç¢ºèª

### æ©Ÿèƒ½è¦ä»¶
- [x] 8ç¨®é¡ã®ãƒªã‚¹ã‚¯æŒ‡æ¨™è¨ˆç®—
- [x] åˆ¶é™é•åã®è‡ªå‹•æ¤œå‡º
- [x] å‹•çš„ã‚¦ã‚§ã‚¤ãƒˆèª¿æ•´
- [x] æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- [x] å±¥æ­´ç®¡ç†ãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

### éæ©Ÿèƒ½è¦ä»¶  
- [x] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶ (6ms/è¨ˆç®—)
- [x] å¯ç”¨æ€§ (ã‚¨ãƒ©ãƒ¼è€æ€§)
- [x] æ‹¡å¼µæ€§ (ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼è¨­è¨ˆ)
- [x] ä¿å®ˆæ€§ (è±Šå¯Œãªãƒ­ã‚°)

### ãƒ†ã‚¹ãƒˆè¦ä»¶
- [x] å˜ä½“ãƒ†ã‚¹ãƒˆ (9ã‚±ãƒ¼ã‚¹æˆåŠŸ)
- [x] çµ±åˆãƒ†ã‚¹ãƒˆ (ã‚·ã‚¹ãƒ†ãƒ é–“é€£æº)
- [x] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿)
- [x] ãƒ‡ãƒ¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆ (å®Ÿç”¨ä¾‹)

---

## ğŸ“‹ çµè«–

**3-3-3ã€Œãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒ¬ãƒ™ãƒ«ã®ãƒªã‚¹ã‚¯èª¿æ•´æ©Ÿèƒ½ã€ã¯å®Œå…¨ã«å®Ÿè£…ã•ã‚Œã€ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã«åˆæ ¼ã—ã¾ã—ãŸã€‚**

æ—¢å­˜ã®3-3-1ï¼ˆã‚·ã‚°ãƒŠãƒ«çµ±åˆï¼‰ã€3-3-2ï¼ˆãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºèª¿æ•´ï¼‰ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆã‚‚æˆåŠŸã—ã€åŒ…æ‹¬çš„ãªãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç®¡ç†ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œæˆã—ã¾ã—ãŸã€‚

### ä¸»è¦æˆæœ:
- âœ… **8ç¨®é¡ã®ãƒªã‚¹ã‚¯æŒ‡æ¨™** ã®é«˜é€Ÿè¨ˆç®— (6ms)
- âœ… **è‡ªå‹•ãƒªã‚¹ã‚¯èª¿æ•´** ã«ã‚ˆã‚‹å‹•çš„ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæœ€é©åŒ–  
- âœ… **æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ å®Œå…¨çµ±åˆ** ã«ã‚ˆã‚‹ä¸€å…ƒç®¡ç†
- âœ… **å®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã®å®‰å®šæ€§** ï¼ˆå…¨ãƒ†ã‚¹ãƒˆåˆæ ¼ï¼‰

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯æœ¬æ ¼çš„ãªé‹ç”¨ç’°å¢ƒã§ã®ä½¿ç”¨æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚
